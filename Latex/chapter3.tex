%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Szablon pracy dyplomowej
% Wydział Informatyki 
% Zachodniopomorski Uniwersytet Technologiczny w Szczecinie
% autor Joanna Kołodziejczyk (jkolodziejczyk@zut.edu.pl)
% Bardzo wczesnym pierwowzorem szablonu był
% The Legrand Orange Book
% Version 5.0 (29/05/2025)
%
% Modifications to LOB assigned by %JK
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%----------------------------------------------------------------------------------------
%	CHAPTER 3
%----------------------------------------------------------------------------------------
\sloppy

\chapter{Projekt}
\label{rozdzial3}

\section{Architektura systemu}
\index{Architektura systemu}
Na podstawię przeprowadzonej analizie dostępnych technologii oraz wymagań funkcjonalnych i niefunkcjonalnych, aplikacja do tworzenia interaktywnego atlasu ptaków w Polsce została zaprojektowana w architekturze 3-warstwowej (3-tier architecture). Wybór ten został podyktowany potrzebą zapewnienia separacji odpowiedzialności i funkcjonalności systemu pomiędzy poszczególnymi warstwami oraz możliwości niezależnego rozwoju każdej z nich i testowanie poszczególnych komponentów.


Projektowana architektura jest następująca:
\begin{itemize}
	\item \textbf{Warstwa prezentacji (Presentation Layer)} - aplikacja kliencka napisana w Angular 17
	\item \textbf{Warstwa logiki biznesowej (Business Logic Layer)} - API REST napisane w ASP.NET Core 8
	\item \textbf{Warstwa danych (Data Layer)} - baza danych SQLite
\end{itemize}

\subsection{Projektowana architektura backendu}
\index{Projektowana architektura backendu}
Backend aplikacji będzie zaimplementowany w technologii \texttt{ASP.NET Core 8}, wykorzystująć wzorzec architektoniczny Model-View-Controller (MVC) w kontekście API REST, wraz z wzorem \texttt{Dependency Injection} oraz \texttt{Repository Pattern}. Projektowana struktura obejmuje niżej wymienione komponenty zgodnie z przyjętą strukturą projektów ASP.NET Core.

\subsubsection{Kontrolery (Controllers)}
Planowane jest utworzenie następujących kontrolerów odpowiedzialnych za obsługę żądań HTTP REST API:
\begin{itemize}
	\item \texttt{AuthController} - zarządzanie uwierzytelnianiem i autoryzacją użytkowników
	\item \texttt{BirdsController} - zarządzanie danymi o ptakach
	\item \texttt{BirdObservationsController} - zarządzanie obserwacjami ptaków
	\item \texttt{UserManagementController} - zarządzanie użytkownikami
	\item \texttt{UserSettingsController} - zarządzanie ustawieniami użytkowników
\end{itemize}

\subsubsection{Serwisy (Services)}
Logika biznesowa zostanie wydzielona do dedykowanych serwisów implementując wzorzec \texttt{Dependency Injection}
\begin{itemize}
	\item \texttt{AuthService} - obsługa uwierzytelniania JWT, zarządzanie tokenami
	\item \texttt{BirdService} - operacje na danych o ptakach
	\item \texttt{BirdObservationService} - operacje na obserwacjach ptaków
	\item \texttt{UserManagementService} - operacje na  użytkownikach
	\item \texttt{UserSettingsService} - operacje związane z ustawieniami użytkowników
\end{itemize}

\subsubsection{Modele danych}
System będzie wykorzystywał Entity Framework Core jako ORM z następującymi głównymi encjami:
\begin{itemize}
	\item \texttt{ApplicationUser} - model użytkownika rozszerzający IdentityUser
	\item \texttt{Bird} - model ptaka zawierający dane taksonomiczne i opisowe
	\item \texttt{BirdObservation} - model obserwacji zawierający lokalizację, datę i dodatkowe informacje
\end{itemize}

\subsubsection{Kontekts bazy danych}
\texttt{ApplicationDbContext} będzie dziedziczyć po \texttt{IdentityDbContext<ApplicationUser>} i definiować relacje między encjami:
\begin{itemize}
	\item Relacja jeden-do-wielu między użytkownikiem a ptakami
	\item Relacja jeden-do-wielu między ptakiem a obserwacjami
	\item Relacja jeden do wielu między użytkownikiem a obserwacjami
\end{itemize}

\subsection{Projektowana architektura frontendu}
\index{Projektowana architektura frontendu}
Część frontendowa aplikacji zostanie zbudowana w technologii Angular 17 z wykorzystaniem Angular Material Design jako biblioteki komponentów UI. Projektowana architektura opiera się na niżej wymienionych założeniach.

\subsubsection{Struktura komponentów}
Aplikacja zostanie podzielona na moduły funkcjonalne:
\begin{itemize}
	\item \textbf{Komponenty stron (Pages)} - główne widoki
	\item \textbf{Komponenty współdzielone (Shared Components)} - komponenty wielokrotnego użytku
	\item \textbf{Komponenty nawigacyjne} - pasek nawigacyjny i routing
\end{itemize}

\subsubsection{Routing i nawigacja}
System routingu będzie wykorzystywał Angular Router z lazy loading dla optymalizacji wydajności:
\begin{itemize}
	\item Strona główna \texttt{(/)}
	\item Zarządzanie ptakami \texttt{(/birds, /birds/:id)}
	\item Obserwacje \texttt{(/observations, /observations/add, /observations/:id)}
	\item Statystyki \texttt{(/statistics)}
	\item Uwierzytelnianie \texttt{(/login, /register, /logout)}
	\item Ustawienia \texttt{(/settings)}
\end{itemize}

\subsubsection{Serwisy aplikacji}
Logika biznesowa frontendu zostanie wydzielona do dedykowanych serwisów:
\begin{itemize}
	\item \texttt{AuthService} - zarządzanie sesją użytkownika i tokenami JWT
	\item \texttt{BirdService} - komunikacja z API ptaków
	\item \texttt{BirdObservationService} - komunikacja z API obserwacji
	\item \texttt{UserService} - zarządzanie danymi użytkownika
\end{itemize}

\subsection{Projektowane bezpieczeństwo systemu}
\index{Projektowane bezpieczeństwo systemu}
Projektowany system będzie wdrażał kilka mechanizmów by zapewnić bezpieczeństwo wymiany informacji oraz danych użytkowników.

\subsubsection{Uwierzytelnianie i autoryzacja}
System będzie wykorzystywał \texttt{JWT} do uwierzytelniania użytkowników:
\begin{itemize}
	\item Tokeny dostępu z czasem życia 15 minut
	\item Tokeny odświeżające z dłuższym czasem życia
	\item Automatyczne odświeżanie tokenów w tle
	\item Role użytkowników: \texttt{Admin} i \texttt{User}
\end{itemize}

\subsubsection{Polityki bezpieczeństwa}
Planowane są następujące polityk autoryzacji:
\begin{itemize}
	\item \texttt{RequireAdminRole} - dostęp tylko dla administratorów
	\item \texttt{RequireUserRole} - dostęp dla zalogowanych użytkowników
	\item Polityki \texttt{CORS} ograniczające dostęp do określonych domen
\end{itemize}

\subsection{Projektowana baza danych}
\index{Projektowana baza danych}
System będzie wykorzystywał bazę danych SQLite, która zapewnia łatwość wdrożenia i konfiguracji, wygodne kopię i przywracanie danych oraz odpowiednia wydajność przy niskim zużyciu zasobów.

\subsubsection{Główne tabele systemu}
\begin{itemize}
	\item \texttt{AspNetUsers} - użytkownicy systemu
	\item \texttt{Birds} - katalog ptaków
	\item \texttt{BirdObservations} - obserwacje ptaków
	\item \texttt{AspNetRoles} - role użytkowników
	\item \texttt{AspNetUserRoles} - przypisanie ról do użytkowników
\end{itemize}

\subsection{Projektowana komunikacja między warstwami}
\index{Projektowana komunikacja między warstwami}
Komunikacja między 3 warstwami projektowanego systemu będzie wyglądać jak zostało to opisane poniżej.

\subsubsection{Komunikacja między frontendem i backendem}
Będzie odbywać się za pośrednictwem REST API:
\begin{itemize}
	\item Endpointy HTTP dla operacji CRUD
	\item Obsługa plików (zdjęcia ptaków i obserwacji)
	\item Walidacja danych po stronie serwera
	\item Obsługa błędów i kodów odpowiedzi HTTP
\end{itemize}

\subsubsection{Komunikacja backendu z bazą danych}
Na backendzie zostanie wykorzystany ORM Entity Framework Core do mapowania obiektowo-relacyjnego i komunikacji z bazą danych. Dzięki wykorzystaniu tej technologii niewymagane jest pisanie surowych zapytań SQL, tylko można wygodnie posługiwać się klasami modelu domenowego, kontekstem bazodanowym i wyrażeń LINQ do przetwarzania danych.

\subsection{Wzorce projektowe}
\index{Wzorce projektowe}
W systemie będą wdrożone i wykorzystane następujące wzorce projektowe:
\begin{itemize}
	\item \textbf{Dependecy Injection} - zarządzanie zależnościami
	\item \textbf{Repository Pattern} - abstrakcja dostępu do danych
	\item \textbf{Service Layer Pattern} - separacja logiki biznesowej
	\item \textbf{DTO Pattern} - tranfer obiektów danych
	\item \textbf{Observer Pattern} - reaktywne programowanie w Angular
\end{itemize}

\section{Model danych}
\index{Model danych}

\section{Diagramy UML}
\index{Diagramy UML}

\section{Projekt interfejsu użytkownika}
\index{Projekt interfejsu użytkownika}

\section{Projekt API}
\index{Projekt API}